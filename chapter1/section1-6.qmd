---
title: "۱-۶ تحلیل رگرسیون مؤلفه‌های اصلی و همبستگی جزئی در آمار چندمتغیره"
format:
  html:
    toc: true
---
[قبلی](section1-5.qmd) | [بعدی](section1-7.qmd)


رگرسیون مؤلفه‌های اصلی (PCR) و همبستگی جزئی دو ابزار قدرتمند در تحلیل چندمتغیره هستند که برای مقابله با مشکلات هم‌خطی و کشف روابط شرطی بین متغیرها استفاده می‌شوند.

## رگرسیون مؤلفه‌های اصلی (PCR)

رگرسیون مؤلفه‌های اصلی یک روش رگرسیون است که از تحلیل مؤلفه‌های اصلی (PCA) برای کاهش ابعاد متغیرهای پیش‌بین‌کننده استفاده می‌کند. در رگرسیون خطی استاندارد، مدل به صورت زیر است:

$$Y = X\beta + \epsilon$$

که در آن $Y$ بردار پاسخ، $X$ ماتریس طراحی (با $n$ مشاهده و $p$ متغیر)، $\beta$ بردار ضرایب، و $\epsilon$ خطا است.

مشکل اصلی در داده‌های چندمتغیره، هم‌خطی (multicollinearity) بین متغیرهای $X$ است که باعث ناپایداری تخمین $\beta$ می‌شود. PCR این مشکل را با تبدیل متغیرهای $X$ به مؤلفه‌های اصلی حل می‌کند.

## مراحل PCR

**۱. تحلیل PCA**: ماتریس واریانس-کوواریانس متغیرهای $X$ محاسبه و تجزیه طیفی آن انجام می‌شود:

$$\text{Cov}(X) = Q\Lambda Q^T$$

که $Q$ ماتریس بردارهای ویژه (مؤلفه‌های اصلی) و $\Lambda$ ماتریس قطری مقادیر ویژه است.

**۲. انتخاب مؤلفه‌ها**: $k$ مؤلفه اصلی (معمولاً با مقادیر ویژه بزرگ) انتخاب می‌شوند که بخش عمده واریانس را توضیح می‌دهند.

**۳. تبدیل داده‌ها**: متغیرهای اصلی به امتیازهای مؤلفه‌ها ($Z = XQ$) تبدیل می‌شوند.

**۴. رگرسیون روی مؤلفه‌ها**: رگرسیون خطی روی $Z$ انجام می‌شود:

$$Y = Z\gamma + \epsilon$$

**۵. بازگشت به متغیرهای اصلی**: ضرایب $\beta$ از $\gamma$ محاسبه می‌شوند:

$$\beta = Q\gamma$$

## مزایا و معایب

**مزایا**:
- کاهش هم‌خطی
- کاهش ابعاد 
- پایداری تخمین‌ها

**معایب**:
- ممکن است مؤلفه‌های با واریانس بالا لزوماً با $Y$ مرتبط نباشند
- منجر به از دست رفتن اطلاعات پیش‌بین‌کننده می‌شود

## مثال عددی

فرض کنید ماتریس واریانس-کوواریانس استانداردشده برای سه متغیر $X_1, X_2, X_3$ به صورت زیر است:

$$\text{Cov}(X) = \begin{pmatrix}
1 & 0.8 & 0.6 \\
0.8 & 1 & 0.5 \\
0.6 & 0.5 & 1
\end{pmatrix}$$

با تجزیه طیفی، مقادیر ویژه $\Lambda = \text{diag}(2.2, 0.7, 0.1)$ و بردارهای ویژه $Q$ محاسبه می‌شوند. دو مؤلفه اول که ۹۶٪ واریانس را توضیح می‌دهند، انتخاب می‌شوند و رگرسیون روی امتیازات آن‌ها انجام می‌گردد.

این روش هم‌خطی بین $X_1, X_2, X_3$ را حذف و مدل پایدارتری ارائه می‌دهد.

## همبستگی جزئی

همبستگی جزئی میزان همبستگی خطی بین دو متغیر $X_i$ و $X_j$ را پس از حذف اثر سایر متغیرها ($X_{rest}$) اندازه‌گیری می‌کند. برای یک توزیع نرمال چندمتغیره، همبستگی جزئی از ماتریس دقت ($\Omega = \Sigma^{-1}$) محاسبه می‌شود:

$$\rho_{ij|rest} = -\frac{\omega_{ij}}{\sqrt{\omega_{ii}\omega_{jj}}}$$

که $\omega_{ij}$ عنصر ماتریس دقت است. این معیار، وابستگی شرطی را نشان می‌دهد و در گراف‌های گاوسی برای شناسائی یال‌ها (edges) استفاده می‌شود.

## رگرسیون جزئی

رگرسیون جزئی به تحلیل رابطه بین $Y$ و یک متغیر پیش‌بین‌کننده $X_i$ پس از حذف اثر سایر متغیرهای $X_{rest}$ می‌پردازد. این روش از باقی‌مانده‌ها برای محاسبه همبستگی استفاده می‌کند:

**۱. باقی‌مانده‌های $X_i$**: $X_i$ روی $X_{rest}$ رگرسیون شده و باقی‌مانده‌ها ($e_{X_i}$) محاسبه می‌شوند.

**۲. باقی‌مانده‌های $Y$**: $Y$ روی $X_{rest}$ رگرسیون شده و باقی‌مانده‌ها ($e_Y$) محاسبه می‌شوند.

**۳. همبستگی جزئی**: همبستگی بین $e_{X_i}$ و $e_Y$ همان همبستگی جزئی ($\rho_{Y,X_i|rest}$) است.

## ارتباط با ماتریس دقت

ماتریس دقت مستقیماً همبستگی جزئی را ارائه می‌دهد، بدون نیاز به محاسبات سنگین باقی‌مانده‌ها. این ویژگی در داده‌های با ابعاد بالا بسیار کارآمد است.

## ارتباط PCR و همبستگی جزئی

PCR و همبستگی جزئی ابزارهای مکمل در تحلیل چندمتغیره هستند:

- **PCR** با کاهش ابعاد، هم‌خطی را حذف می‌کند، اما ممکن است مؤلفه‌های با واریانس بالا لزوماً با $Y$ مرتبط نباشند.

- **همبستگی جزئی** می‌تواند برای شناسایی متغیرهای کلیدی قبل از PCA استفاده شود.

- **ماتریس دقت** در هر دو روش نقش دارد؛ در PCR برای استانداردسازی داده‌ها و در همبستگی جزئی برای محاسبه مستقیم همبستگی‌های شرطی.

## مثال یکپارچه

فرض کنید یک داده‌ست با متغیرهای $X_1, X_2, X_3, Y$ داریم:

**۱. همبستگی جزئی**: ماتریس دقت محاسبه شده و نشان می‌دهد $X_3$ با $Y$ به شرط $X_1, X_2$ همبستگی پایینی دارد. بنابراین، $X_3$ ممکن است از مدل حذف شود.

**۲. PCR**: PCA روی $X_1, X_2$ انجام شده، دو مؤلفه اصلی انتخاب می‌شوند، و رگرسیون روی امتیازهای مؤلفه‌ها اجرا می‌شود.

**۳. مقایسه باقی‌مانده‌ها**: باقی‌مانده‌های رگرسیون PCR با باقی‌مانده‌های رگرسیون جزئی مقایسه می‌شوند تا دقت مدل ارزیابی شود.

## جدول مقایسه

| معیار | PCR | رگرسیون جزئی |
|--------|-----|--------------|
| هدف | کاهش ابعاد، حذف هم‌خطی | تحلیل وابستگی شرطی |
| استفاده از Ω | غیرمستقیم (از طریق PCA) | مستقیم (برای همبستگی جزئی) |
| پیچیدگی | متوسط | بالا در ابعاد زیاد |

## کاربردهای ترکیبی

- **تحلیل داده‌های پیچیده**: در داده‌های ژنومی، ابتدا همبستگی جزئی برای شناسائی ژن‌های کلیدی و سپس PCR برای مدل‌سازی استفاده می‌شود.

- **گراف‌های شبکه‌ای**: همبستگی جزئی برای ساخت گراف‌های بدون جهت استفاده شده و PCR برای پیش‌بینی متغیرها در گراف‌های جهت‌دار.

- **یادگیری ماشین**: ترکیب این روش‌ها برای پیش‌پردازش داده‌ها و بهبود مدل‌های پیش‌بین‌کننده.

---

[قبلی](section1-5.qmd) | [بعدی](section1-7.qmd)
