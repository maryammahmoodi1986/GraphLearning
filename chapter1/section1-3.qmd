---
title: "۱-۳: ماتریس دقت و ارتباط آن با ماتریس واریانس-کوواریانس"
---

[قبلی](section1-2.qmd) | [بعدی](section1-4.qmd)

در آمار چندمتغیره، علاوه بر ماتریس واریانس-کوواریانس که روابط خطی بین متغیرها را توصیف می‌کند، **ماتریس دقت** نیز نقش بنیادی در درک ساختار وابستگی شرطی بین متغیرها ایفا می‌کند. این درس به بررسی عمیق این دو مفهوم و ارتباطات آن‌ها می‌پردازد.

## تعریف ماتریس واریانس-کوواریانس

ماتریس واریانس-کوواریانس، که معمولاً با نماد $\Sigma$ نمایش داده می‌شود، ماتریسی متقارن و مثبت معین است که واریانس‌ها و کوواریانس‌های یک بردار تصادفی را توصیف می‌کند.

اگر 
$$X = (X_1, X_2, \ldots, X_p)^T$$
یک بردار تصادفی با میانگین 
$$\mu = E[X]$$
باشد، آنگاه ماتریس واریانس-کوواریانس به‌صورت زیر تعریف می‌شود:

$$\Sigma = \text{Cov}(X) = E[(X - \mu)(X - \mu)^T]$$

### ساختار ماتریس واریانس-کوواریانس

$$\Sigma = \begin{pmatrix}
\sigma_{11} & \sigma_{12} & \cdots & \sigma_{1p} \\
\sigma_{21} & \sigma_{22} & \cdots & \sigma_{2p} \\
\vdots & \vdots & \ddots & \vdots \\
\sigma_{p1} & \sigma_{p2} & \cdots & \sigma_{pp}
\end{pmatrix}$$

که در آن:
- $\sigma_{ii} = \text{Var}(X_i)$: واریانس متغیر $X_i$
- $\sigma_{ij} = \text{Cov}(X_i, X_j)$: کوواریانس بین متغیرهای $X_i$ و $X_j$
- $\sigma_{ij} = \sigma_{ji}$: خاصیت تقارن

### خواص ماتریس واریانس-کوواریانس

**متقارن بودن:** $\Sigma = \Sigma^T$

**مثبت نیمه‌معین:** $x^T \Sigma x \geq 0$ برای هر بردار $x$

**غیرمنفرد بودن:** در صورت عدم وجود وابستگی خطی کامل بین متغیرها

## ماتریس دقت

ماتریس دقت (Precision Matrix) که با نماد $\Omega$ یا $\Sigma^{-1}$ نشان داده می‌شود، وارون ماتریس واریانس-کوواریانس است:

$$\Omega = \Sigma^{-1}$$

### تفسیر آماری ماتریس دقت

**استقلال شرطی:** اگر $\omega_{ij} = 0$ باشد، آنگاه متغیرهای $X_i$ و $X_j$ به شرط سایر متغیرها مستقل هستند.

**همبستگی جزئی:** عناصر غیرقطری ماتریس دقت با همبستگی‌های جزئی مرتبط هستند.

**دقت اطلاعات:** عناصر قطری نشان‌دهنده دقت اطلاعات هر متغیر (وارون واریانس شرطی) هستند.

### خواص ماتریس دقت

برای یک توزیع نرمال چندمتغیره $N(\mu, \Sigma)$، ماتریس دقت دارای خواص زیر است:

**شرطی بودن اطلاعات:** $\omega_{ii}$ دقت متغیر $X_i$ به شرط سایر متغیرها را نشان می‌دهد

**پراکندگی شرطی:** 
$$\text{Var}(X_i | X_{-i}) = \frac{1}{\omega_{ii}}$$

که $X_{-i}$ نشان‌دهنده تمام متغیرها به جز $X_i$ است.

## ارتباط بین ماتریس واریانس-کوواریانس و ماتریس دقت

### رابطه بنیادی

ارتباط بین $\Sigma$ و $\Omega$ از طریق رابطه وارون زیر مشخص می‌شود:

$$\Sigma \Omega = \Omega \Sigma = I$$

که در آن $I$ ماتریس همانی است.

### تفسیر عناصر

در حالی که $\sigma_{ij}$ کوواریانس مستقیم بین $X_i$ و $X_j$ را نشان می‌دهد، عنصر $\omega_{ij}$ با **همبستگی جزئی** بین آن‌ها مرتبط است:

$$\rho_{ij \cdot \text{rest}} = -\frac{\omega_{ij}}{\sqrt{\omega_{ii} \omega_{jj}}}$$

### مقایسه تفسیری

| جنبه | ماتریس واریانس-کوواریانس | ماتریس دقت |
|------|---------------------------|------------|
| تفسیر عناصر | کوواریانس مستقیم | همبستگی جزئی |
| استقلال | استقلال کامل | استقلال شرطی |
| اطلاعات | پراکندگی حاشیه‌ای | پراکندگی شرطی |
| کاربرد | توصیف توزیع | مدل‌سازی وابستگی |

## کاربردهای ماتریس دقت

### مدل‌های گرافی گاوسی

ماتریس دقت در **مدل‌های گرافی گاوسی** (Gaussian Graphical Models) نقش کلیدی دارد:

- **گراف بدون جهت:** هر متغیر به عنوان یک رأس در نظر گرفته می‌شود
- **یال‌ها:** اگر $\omega_{ij} \neq 0$، یالی بین رئوس $i$ و $j$ وجود دارد
- **تفسیر:** یال‌ها نشان‌دهنده وابستگی شرطی مستقیم هستند

### تحلیل رگرسیون

در تحلیل رگرسیون چندمتغیره:

**ضرایب رگرسیون شرطی:**
$$\beta_{j \to i} = -\frac{\omega_{ij}}{\omega_{jj}}$$

**R-squared شرطی:**
$$R^2_{i \cdot -i} = 1 - \frac{1}{\sigma_{ii} \omega_{ii}}$$

### یادگیری ساختار

**انتخاب مدل:** تعیین ساختار پراکندگی بر اساس صفر بودن عناصر ماتریس دقت

**کاهش ابعاد:** شناسایی متغیرهایی که به شرط سایرین مستقل هستند

**تشخیص الگو:** کشف روابط پنهان و ساختارهای مخفی در داده

### الگوریتم‌های بهینه‌سازی

**Graphical LASSO:**
$$\min_{\Omega \succ 0} \left\{ \text{tr}(S\Omega) - \log \det(\Omega) + \lambda \|\Omega\|_1 \right\}$$

که $S$ ماتریس کوواریانس نمونه و $\lambda$ پارامتر تنظیم‌سازی است.

## ملاحظات عملی

### شرایط وجود

برای وجود ماتریس دقت:
- ماتریس واریانس-کوواریانس باید غیرمنفرد باشد
- تعداد مشاهدات باید بیشتر از تعداد متغیرها باشد
- داده‌ها نباید دارای وابستگی خطی کامل باشند

### چالش‌های محاسباتی

**ابعاد بالا:** وقتی $p > n$، ماتریس واریانس-کوواریانس نمونه منفرد است

**تنظیم‌سازی:** استفاده از روش‌های تنظیم‌سازی مانند Ridge یا LASSO

**پایداری عددی:** مراقبت در محاسبه وارون ماتریس‌های بدشرط

### روش‌های برآورد

**برآوردگر کلاسیک:**
$$\hat{\Omega} = S^{-1}$$

**برآورد تنظیم‌شده:**
$$\hat{\Omega}_{\lambda} = \arg\min_{\Omega} \left\{ \text{tr}(S\Omega) - \log \det(\Omega) + \lambda \|\Omega\|_1 \right\}$$

**روش‌های بیزی:**
استفاده از پیشین‌های مناسب برای ماتریس دقت

## مثال کاربردی

فرض کنید سه متغیر $X_1$، $X_2$، و $X_3$ داریم که:

$$\Sigma = \begin{pmatrix}
4 & 2 & 0 \\
2 & 3 & 1 \\
0 & 1 & 2
\end{pmatrix}$$

ماتریس دقت برابر است با:

$$\Omega = \Sigma^{-1} = \begin{pmatrix}
0.3 & -0.2 & 0.1 \\
-0.2 & 0.6 & -0.3 \\
0.1 & -0.3 & 0.65
\end{pmatrix}$$

**تفسیر:** چون $\omega_{13} \neq 0$، متغیرهای $X_1$ و $X_3$ به شرط $X_2$ مستقل نیستند، اما کوواریانس حاشیه‌ای آن‌ها صفر است ($\sigma_{13} = 0$).

## خلاصه

ماتریس دقت ابزاری قدرتمند برای درک ساختار وابستگی‌های شرطی در داده‌های چندمتغیره است. در حالی که ماتریس واریانس-کوواریانس روابط حاشیه‌ای را توصیف می‌کند، ماتریس دقت اطلاعات عمیق‌تری درباره روابط مستقیم بین متغیرها ارائه می‌دهد.

درک صحیح این مفاهیم پایه‌ای محکم برای تسلط بر روش‌های پیشرفته‌تر مانند مدل‌های گرافی، تحلیل شبکه و یادگیری ساختار فراهم می‌کند.

---

[قبلی](section1-2.qmd) | [بعدی](section1-4.qmd)

