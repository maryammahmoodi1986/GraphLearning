---
title: " ارزیابی گراف‌های غیرجهت‌دار در مدل‌های گرافیکی گاوسی"
---
[قبلی](section2-1.qmd) | [بعدی](section2-3.qmd)

---


در مدل‌های گرافیکی گاوسی (GGMs - Gaussian Graphical Models)، هدف اصلی استنباط ساختار یک گراف غیرجهت‌دار است که نشان‌دهنده وابستگی‌های شرطی بین متغیرهای تصادفی با توزیع نرمال چندمتغیره است. در این مدل‌ها، هر گره در گراف نشان‌دهنده یک متغیر تصادفی و عدم وجود یال بین دو گره نشان‌دهنده استقلال شرطی آن دو متغیر با توجه به سایر متغیرها است.

در یک مدل گاوسی، ساختار گراف مستقیماً به ماتریس دقت $\Sigma^{-1}$ (Precision Matrix) مرتبط است. درایه‌های غیرقطری ماتریس دقت که برابر صفر هستند، نشان‌دهنده استقلال شرطی متغیرهای مربوطه می‌باشند.

برای استنباط ساختار گراف از داده‌ها، معمولاً از روش‌های مبتنی بر پنالتی‌گذاری (Penalized methods) مانند Graphical Lasso استفاده می‌شود. این روش‌ها با اعمال جریمه بر پیچیدگی مدل (تعداد یال‌ها)، به دنبال یافتن گراف‌های خلوت (Sparse) هستند که تفسیرپذیرتر بوده و از پدیده بیش‌برازش (Overfitting) جلوگیری می‌کنند.

پس از تخمین مدل‌های گرافیکی مختلف (به عنوان مثال، با مقادیر مختلف پارامتر پنالتی)، نیاز به ارزیابی و انتخاب بهترین مدل از بین آن‌ها وجود دارد. این ارزیابی معمولاً با استفاده از توابع امتیاز (Scoring Functions) صورت می‌گیرد که تعادلی بین برازش مدل به داده‌ها و پیچیدگی آن برقرار می‌کنند.

## توابع امتیاز برای ارزیابی گراف‌های غیرجهت‌دار

توابع امتیاز، معیارهایی هستند که به هر گراف (یا ماتریس دقت متناظر با آن) یک مقدار عددی نسبت می‌دهند. این مقدار نشان‌دهنده کیفیت گراف از نظر برازش به داده‌ها و پیچیدگی ساختاری آن است. توابع امتیاز رایج در مدل‌های گرافیکی گاوسی عبارتند از:

۱.تابع درست‌نمایی لگاریتم (Log-Likelihood)

تابع درست‌نمایی لگاریتم، میزان برازش مدل به داده‌ها را اندازه‌گیری می‌کند. برای یک مجموعه داده $X$ با $n$ نمونه و $p$ متغیر که از توزیع نرمال چندمتغیره با ماتریس کوواریانس $\Sigma$ پیروی می‌کند، و ماتریس دقت $\Sigma^{-1} = \Theta$، تابع درست‌نمایی لگاریتم (به جز ثابت‌ها) به صورت زیر تعریف می‌شود:

$$\ell(\Theta; S) = \frac{n}{2}[\log \det(\Theta) - \text{trace}(S\Theta)]$$

در اینجا $S$ ماتریس کوواریانس نمونه است: $S = \frac{1}{n}X^TX$.

هر چه مقدار تابع درست‌نمایی لگاریتم بزرگ‌تر باشد، برازش مدل به داده‌ها بهتر است. با این حال، صرفاً استفاده از تابع درست‌نمایی لگاریتم برای انتخاب مدل مناسب نیست، زیرا با افزایش پیچیدگی مدل (اضافه کردن یال‌ها)، مقدار آن همواره افزایش می‌یابد و منجر به انتخاب مدل‌های پیچیده‌تر و احتمالاً بیش‌برازش‌شده می‌شود.

 ۲. معیار اطلاعات آکائیکه (AIC)

معیار اطلاعات آکائیکه (AIC - Akaike Information Criterion) برای مقایسه مدل‌های مختلف و انتخاب مدل که بهترین برازش را با کمترین پیچیدگی ارائه می‌دهد، به کار می‌رود. AIC با افزودن یک جریمه برای پیچیدگی مدل به تابع درست‌نمایی لگاریتم، تعادلی بین برازش و سادگی مدل ایجاد می‌کند.

فرمول AIC به صورت زیر است:

$$AIC = -2\ell(\Theta; S) + 2 \times df$$

در اینجا $df$ (degrees of freedom) نشان‌دهنده تعداد پارامترهای آزاد در مدل است که در گراف‌های گاوسی، تقریباً برابر با تعداد درایه‌های غیرصفر بالای قطری در ماتریس دقت به علاوه $p$ (تعداد متغیرها) است.

مدل با AIC کوچک‌تر، ارجحیت دارد. AIC به طور معمول نسبت به BIC مدل‌های پیچیده‌تری را انتخاب می‌کند.

 ۳. معیار اطلاعات بیزی (BIC)

معیار اطلاعات بیزی (BIC - Bayesian Information Criterion) مشابه AIC است، اما جریمه سنگین‌تری برای پیچیدگی مدل در نظر می‌گیرد. BIC به‌خصوص در مواردی که تعداد نمونه‌ها زیاد است، تمایل به انتخاب مدل‌های ساده‌تر و خلوت‌تر دارد.

فرمول BIC به صورت زیر است:

$$BIC = -2\ell(\Theta; S) + \log(n) \times df$$

در اینجا $n$ تعداد نمونه‌ها است. مدل با BIC کوچک‌تر، ارجحیت دارد. BIC در شرایطی که تعداد نمونه‌ها به سمت بی‌نهایت میل می‌کند $(n \to \infty)$، سازگار است و مدل‌های ساده‌تر را ترجیح می‌دهد.

 ۴. معیار اطلاعات بیزی توسعه‌یافته (EBIC)

معیار اطلاعات بیزی توسعه‌یافته (EBIC - Extended Bayesian Information Criterion) به ویژه برای مدل‌های گرافیکی گاوسی در ابعاد بالا (high-dimensional) که تعداد متغیرها $(p)$ زیاد و تعداد نمونه‌ها $(n)$ نسبتاً کم است، طراحی شده است. EBIC با افزودن یک پارامتر تنظیم $\gamma$ (gamma) به BIC، امکان کنترل بیشتر بر میزان خلوت گراف را فراهم می‌کند.

فرمول EBIC به صورت زیر است:

$$EBIC(\gamma) = -2\ell(\Theta; S) + \log(n) \times df + 4\gamma \times \log\binom{p}{2} \times (df - p)$$

در اینجا $\gamma$ یک پارامتر تنظیم است که مقدار آن معمولاً بین ۰ و ۱ انتخاب می‌شود. وقتی $\gamma = 0$ باشد، EBIC معادل BIC معمولی است. افزایش مقدار $\gamma$ منجر به انتخاب گراف‌های خلوت‌تر می‌شود.

مقدار $\gamma = 0.5$ به عنوان یک مقدار پیش‌فرض مناسب برای ایجاد تعادل بین پیچیدگی و برازش مدل توصیه می‌شود. EBIC نسبت به BIC و AIC در شرایط ابعاد بالا عملکرد بهتری دارد و به کاهش نرخ کشف اشتباه (False Discovery Rate) کمک می‌کند.

## تخمین ماتریس دقت با Graphical Lasso

برای تخمین ماتریس دقت $\Theta$ با اعمال قید خلوت، روش Graphical Lasso به طور گسترده‌ای مورد استفاده قرار می‌گیرد. Graphical Lasso یک روش بهینه‌سازی محدب است که به دنبال حل مسئله زیر است:

$$\text{maximize } \ell(\Theta) - \lambda\|\Theta\|_1$$

در اینجا $\|\Theta\|_1$ نرم L1 ماتریس $\Theta$ است که مجموع قدر مطلق درایه‌های آن را نشان می‌دهد و $\lambda$ پارامتر پنالتی است که میزان خلوت گراف را کنترل می‌کند. افزایش مقدار $\lambda$ منجر به خلوت‌تر شدن گراف تخمین می‌شود.

برای انتخاب مقدار مناسب $\lambda$، می‌توان از روش‌های Cross Validation، AIC، BIC یا EBIC استفاده کرد.

## روش انتخاب بهترین گراف با استفاده از توابع امتیاز

برای انتخاب بهترین گراف غیرجهت‌دار از بین مجموعه‌ای از گراف‌های کاندید (که معمولاً با مقادیر مختلف $\lambda$ در Graphical Lasso تخمین زده می‌شوند)، می‌توان از روال زیر استفاده کرد:

۱. تعیین طیف مقادیر پنالتی

مجموعه‌ای از مقادیر $\lambda$ را برای Graphical Lasso انتخاب کنید. این مقادیر معمولاً به صورت لگاریتمی بین یک مقدار حداقل و یک مقدار حداکثر توزیع می‌شوند.

۲. تخمین گراف برای هر مقدار پنالتی

برای هر مقدار $\lambda$، با استفاده از Graphical Lasso، ماتریس دقت $\hat{\Theta}(\lambda)$ را تخمین بزنید.

۳. محاسبه تابع امتیاز

برای هر گراف تخمین $\hat{\Theta}(\lambda)$، مقدار تابع امتیاز مورد نظر (AIC، BIC یا EBIC) را با استفاده از فرمول‌های مربوطه محاسبه کنید. برای محاسبه نیاز به ماتریس کوواریانس نمونه $S$ و تعداد نمونه‌ها $n$ دارید.

۴. انتخاب بهترین پارامتر

مقدار $\lambda^*$ را انتخاب کنید که کمترین مقدار تابع امتیاز را به دست دهد.

۵. گزارش گراف بهینه

گراف غیرجهت‌دار متناظر با ماتریس دقت $\hat{\Theta}(\lambda^*)$ را به عنوان گراف بهینه گزارش کنید.

## ابزارهای عملی

در عمل، کتابخانه‌هایی مانند scikit-learn در پایتون و glasso در R ابزارهایی برای اجرای Graphical Lasso و محاسبه معیارهای AIC و BIC فراهم کرده‌اند که فرآیند انتخاب مدل را تسهیل می‌کنند.

برای انتخاب $\lambda$ می‌توان از روش اعتبارسنجی متقابل (GraphicalLassoCV در scikit-learn) یا از معیارهای اطلاعاتی مانند BIC و EBIC (QuicGraphLassoEBIC در کتابخانه skggm) استفاده کرد.

## مقایسه معیارهای انتخاب مدل

- **AIC**: مناسب برای داده‌های با حجم متوسط، تمایل به انتخاب مدل‌های نسبتاً پیچیده
- **BIC**: مناسب برای داده‌های با حجم بالا، تمایل به انتخاب مدل‌های ساده‌تر از AIC
- **EBIC**: بهترین عملکرد در ابعاد بالا، کنترل قابل تنظیم بر خلوت گراف، کاهش نرخ کشف اشتباه

## جمع‌بندی

ارزیابی و انتخاب گراف‌های غیرجهت‌دار در مدل‌های گرافیکی گاوسی نقش حیاتی در استخراج ساختارهای وابستگی معنادار از داده‌ها دارد. توابع امتیاز مختلف هر کدام مزایا و کاربردهای خاص خود را دارند و انتخاب مناسب بین آن‌ها بستگی به ماهیت داده‌ها و اهداف تحلیل دارد.

درک عمیق این معیارها و نحوه کاربرد آن‌ها در کنار روش‌های پنالتی مانند Graphical Lasso، ابزار قدرتمندی برای مدل‌سازی روابط پیچیده در داده‌های چندمتغیره فراهم می‌آورد. این رویکرد در کاربردهای متنوعی از تحلیل ژنومیک تا شبکه‌های اجتماعی و مالی مورد استفاده قرار می‌گیرد.

---

[قبلی](section2-1.qmd) | [بعدی](section2-3.qmd)
